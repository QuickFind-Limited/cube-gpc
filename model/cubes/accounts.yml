cubes:
  - name: accounts
    sql: SELECT * FROM `gpc_data_2026_01_26.accounts`
    title: Chart of Accounts
    description: >
      General ledger chart of accounts with hierarchical structure and account attributes.
      Grain: one row per GL account.

    measures:
      - name: accounts_count
        type: count
        description: Total number of GL accounts

    dimensions:
      - name: account_id
        sql: "{{CUBE}}.account_id"
        type: number
        primary_key: true
        description: Unique identifier for the GL account

      - name: account_number
        sql: "{{CUBE}}.account_number"
        type: string
        description: Account number (may contain duplicates for multi-subsidiary accounts)

      - name: account_name
        sql: "{{CUBE}}.account_name"
        type: string
        description: Account name

      - name: account_display_name
        sql: "{{CUBE}}.account_display_name"
        type: string
        description: Display name for the account (typically account_number + account_name)

      - name: account_hierarchy_name
        sql: "{{CUBE}}.account_hierarchy_name"
        type: string
        description: Hierarchical path name showing parent account structure

      - name: account_type
        sql: "{{CUBE}}.account_type"
        type: string
        description: Account type (Asset, Liability, Equity, Income, Expense, etc.)

      - name: external_id
        sql: "{{CUBE}}.external_id"
        type: string
        description: External system identifier for integration

      - name: subsidiary_ids
        sql: "{{CUBE}}.subsidiary_ids"
        type: string
        description: Comma-separated list of subsidiary IDs this account applies to

      - name: currency_id
        sql: "{{CUBE}}.currency_id"
        type: number
        description: Currency ID for monetary accounts (Bank, Credit Card)

      - name: is_inactive
        sql: "{{CUBE}}.is_inactive"
        type: boolean
        description: Indicates if the account is inactive

      - name: is_summary
        sql: "{{CUBE}}.is_summary"
        type: boolean
        description: Indicates if this is a summary/parent account (not for posting)

      - name: include_children
        sql: "{{CUBE}}.include_children"
        type: boolean
        description: Indicates if child account balances roll up to this account

      - name: is_eliminate
        sql: "{{CUBE}}.is_eliminate"
        type: boolean
        description: Indicates if this is an elimination account for consolidation

      - name: reconcile_with_matching
        sql: "{{CUBE}}.reconcile_with_matching"
        type: boolean
        description: Indicates if account requires reconciliation with matching

      - name: is_revalue
        sql: "{{CUBE}}.is_revalue"
        type: boolean
        description: Indicates if account is subject to currency revaluation

      - name: is_inventory
        sql: "{{CUBE}}.is_inventory"
        type: boolean
        description: Indicates if this is an inventory account

      - name: cashflow_rate
        sql: "{{CUBE}}.cashflow_rate"
        type: string
        description: Exchange rate type for cash flow reporting

      - name: general_rate
        sql: "{{CUBE}}.general_rate"
        type: string
        description: Exchange rate type for general ledger reporting

      - name: last_modified_date
        sql: "TIMESTAMP({{CUBE}}.last_modified_date)"
        type: time
        description: Date when the account was last modified

    segments:
      - name: active_accounts
        sql: "{{CUBE}}.is_inactive = false"
        description: "Active accounts available for use"

      - name: posting_accounts
        sql: "{{CUBE}}.is_summary = false"
        description: "Accounts available for transaction posting (excludes summary/parent accounts)"

      - name: summary_accounts
        sql: "{{CUBE}}.is_summary = true"
        description: "Summary/parent accounts used for reporting hierarchies"

      - name: inventory_accounts
        sql: "{{CUBE}}.is_inventory = true"
        description: "Inventory-related accounts"

      - name: elimination_accounts
        sql: "{{CUBE}}.is_eliminate = true"
        description: "Elimination accounts used in consolidation"

      - name: monetary_accounts
        sql: "{{CUBE}}.currency_id IS NOT NULL"
        description: "Accounts with specific currency (Bank, Credit Card accounts)"
