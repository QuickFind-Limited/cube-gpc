cubes:
  - name: b2b_addresses
    sql: SELECT * FROM b2b_addresses
    title: B2B Addresses
    description: B2B address reference data for shipping and billing

    measures:
      - name: address_count
        type: count
        description: Total number of addresses

    dimensions:
      - name: address_id
        sql: "{CUBE}.address_id"
        type: number
        primary_key: true

      - name: addressee
        sql: "{CUBE}.addressee"
        type: string
        description: Addressee name

      - name: addr1
        sql: "{CUBE}.addr1"
        type: string
        description: Address line 1

      - name: addr2
        sql: "{CUBE}.addr2"
        type: string
        description: Address line 2

      - name: city
        sql: "{CUBE}.city"
        type: string
        description: City

      - name: country
        sql: "{CUBE}.country"
        type: string
        description: Country code

      - name: addrphone
        sql: "{CUBE}.addrphone"
        type: string
        description: Address phone number

      - name: full_address
        sql: "{CUBE}.full_address"
        type: string
        description: Full formatted address

      - name: lastmodifieddate
        sql: "CAST({CUBE}.lastmodifieddate AS TIMESTAMP)"
        type: time
        description: Last modified date

      - name: override
        sql: "{CUBE}.override"
        type: string
        description: Override flag (T/F)

      - name: recordowner
        sql: "{CUBE}.recordowner"
        type: number
        description: Record owner ID

    pre_aggregations:
      - name: address_analysis
        measures:
          - address_count
        dimensions:
          - country
          - city
        refresh_key:
          every: 1 hour
