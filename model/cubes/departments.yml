cubes:
  - name: departments
    sql: SELECT * FROM gpc_data_2026_01_26.departments
    title: Departments
    description: Department reference data (eCommerce, Retail, Wholesale, etc.)

    measures:
      - name: department_count
        type: count
        description: Total number of departments

      - name: active_department_count
        type: count
        filters:
          - sql: "{CUBE}.is_inactive = false"
        description: Number of active departments

    dimensions:
      - name: department_id
        sql: "{CUBE}.department_id"
        type: number
        primary_key: true
        description: Unique identifier for the department

      - name: department_name
        sql: "{CUBE}.department_name"
        type: string
        description: Department name (eCommerce, Retail, Wholesale)

      - name: department_fullname
        sql: "{CUBE}.department_fullname"
        type: string
        description: Full department name with hierarchy path

      - name: is_inactive
        sql: "{CUBE}.is_inactive"
        type: boolean
        description: True if department is inactive

      - name: last_modified_date
        sql: "TIMESTAMP({CUBE}.last_modified_date)"
        type: time
        description: Last date this department record was modified

    segments:
      - name: active
        sql: "{CUBE}.is_inactive = false"
        description: "Active departments only"

      - name: inactive
        sql: "{CUBE}.is_inactive = true"
        description: "Inactive departments only"

    pre_aggregations:
      - name: department_analysis
        measures:
          - department_count
          - active_department_count
        dimensions:
          - department_name
        refresh_key:
          every: 1 day
