cubes:
  - name: payment_methods
    sql_table: gpc_data_2026_01_26.payment_methods
    title: Payment Methods
    description: >
      Payment method dimension containing all available payment methods (credit cards, cash, EFT, etc.).
      Grain: one row per payment method.

    measures:
      - name: payment_method_count
        type: count
        description: Total number of payment methods

    dimensions:
      - name: payment_method_id
        sql: "{CUBE}.payment_method_id"
        type: number
        primary_key: true
        description: Unique identifier for the payment method

      - name: payment_method_name
        sql: "{CUBE}.payment_method_name"
        type: string
        description: Display name of the payment method (e.g., VISA, Mastercard, Cash, PayPal)

      - name: is_inactive
        sql: "{CUBE}.is_inactive"
        type: boolean
        description: Indicates if the payment method is inactive

    segments:
      - name: active_only
        sql: "{CUBE}.is_inactive = false"
        description: "Active payment methods only"

      - name: credit_cards
        sql: "UPPER({CUBE}.payment_method_name) LIKE '%VISA%' OR UPPER({CUBE}.payment_method_name) LIKE '%MASTERCARD%' OR UPPER({CUBE}.payment_method_name) LIKE '%AMEX%' OR UPPER({CUBE}.payment_method_name) LIKE '%CARD%'"
        description: "Credit card payment methods"

      - name: digital_payments
        sql: "UPPER({CUBE}.payment_method_name) LIKE '%PAYPAL%' OR UPPER({CUBE}.payment_method_name) LIKE '%STRIPE%' OR UPPER({CUBE}.payment_method_name) LIKE '%CLEARPAY%' OR UPPER({CUBE}.payment_method_name) LIKE '%KLARNA%'"
        description: "Digital/online payment methods"
