cubes:
  - name: dim_employee
    sql: SELECT * FROM gpc_data_2026_01_26.dim_employee
    title: Employees
    description: >
      Employee dimension for sales rep attribution and HR analytics.
      Grain: one row per employee.

    joins:
      - name: dim_subsidiary
        relationship: many_to_one
        sql: "{CUBE}.subsidiary_id = {dim_subsidiary.subsidiary_id}"

    measures:
      - name: employee_count
        type: count
        description: Total number of employees

      - name: active_employee_count
        type: count
        sql: "{CUBE}.employee_id"
        filters:
          - sql: "{CUBE}.is_inactive = false"
        description: Count of active employees

      - name: sales_rep_count
        type: count
        sql: "{CUBE}.employee_id"
        filters:
          - sql: "{CUBE}.is_sales_rep = true AND {CUBE}.is_inactive = false"
        description: Count of active sales representatives

    dimensions:
      - name: employee_id
        sql: "{CUBE}.employee_id"
        type: number
        primary_key: true
        description: Unique identifier for the employee

      - name: employee_code
        sql: "{CUBE}.employee_code"
        type: string
        description: Employee code or number from HR system

      - name: first_name
        sql: "{CUBE}.first_name"
        type: string
        description: Employee first name

      - name: last_name
        sql: "{CUBE}.last_name"
        type: string
        description: Employee last name

      - name: full_name
        sql: "CONCAT({CUBE}.first_name, ' ', {CUBE}.last_name)"
        type: string
        description: Employee full name (first and last)

      - name: employee_email
        sql: "{CUBE}.employee_email"
        type: string
        description: Employee email address

      - name: subsidiary_id
        sql: "{CUBE}.subsidiary_id"
        type: number
        description: Foreign key to subsidiary (legal entity)

      - name: is_inactive
        sql: "{CUBE}.is_inactive"
        type: boolean
        description: True if the employee is inactive or terminated

      - name: is_sales_rep
        sql: "{CUBE}.is_sales_rep"
        type: boolean
        description: True if the employee is a sales representative

      - name: hire_date
        sql: "TIMESTAMP({CUBE}.hire_date)"
        type: time
        description: Date the employee was hired

      - name: last_modified_date
        sql: "TIMESTAMP({CUBE}.last_modified_date)"
        type: time
        description: Last date the employee record was modified

    segments:
      - name: active_employees
        sql: "{CUBE}.is_inactive = false"
        description: "Active employees only (excludes terminated/inactive)"

      - name: sales_reps
        sql: "{CUBE}.is_sales_rep = true AND {CUBE}.is_inactive = false"
        description: "Active sales representatives only"

      - name: non_sales_employees
        sql: "{CUBE}.is_sales_rep = false AND {CUBE}.is_inactive = false"
        description: "Active employees who are not sales reps"
