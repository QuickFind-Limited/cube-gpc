cubes:
  - name: classifications
    sql: SELECT * FROM gpc_data_2026_01_26.classifications
    title: Classifications
    description: >
      Business classification hierarchy (EU Website, UK Website, Kildare Village, etc.).
      Grain: one row per classification (store/location category).

    joins:
      - name: parent_classification
        relationship: many_to_one
        sql: "{CUBE}.classification_id = {parent_classification.classification_id}"

    measures:
      - name: classification_count
        type: count
        description: Total number of classifications

      - name: active_count
        type: count
        filters:
          - sql: "{CUBE}.is_inactive = false"
        description: Number of active classifications

    dimensions:
      - name: classification_id
        sql: "{CUBE}.classification_id"
        type: number
        primary_key: true
        description: Unique identifier for the classification

      - name: classification_name
        sql: "{CUBE}.classification_name"
        type: string
        description: Classification name (EU Website, UK Website, Kildare Village, etc.)

      - name: is_inactive
        sql: "{CUBE}.is_inactive"
        type: boolean
        description: Whether classification is inactive

    segments:
      - name: active
        sql: "{CUBE}.is_inactive = false"
        description: "Excludes inactive classifications"

    pre_aggregations:
      - name: classification_analysis
        measures:
          - classification_count
          - active_count
        dimensions:
          - classification_name
        refresh_key:
          every: 1 day
